<!DOCTYPE html> 
<html> 
	<head> 
	<title>Klassio RSV</title> 
	<meta id="extViewportMeta" name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black" />	

	<!-- Home screen icon  Mathias Bynens mathiasbynens.be/notes/touch-icons -->
	<!-- For iPhone 4 with high-resolution Retina display: -->
	<link rel="apple-touch-icon-precomposed" sizes="114x114" href="images/icon.png">
	<!-- For first-generation iPad: -->
	<link rel="apple-touch-icon-precomposed" sizes="72x72" href="images/icon.png">
	<!-- For non-Retina iPhone, iPod Touch, and Android 2.1+ devices: -->
	<link rel="apple-touch-icon-precomposed" href="images/icon.png">
	<!-- For nokia devices: -->
	<link rel="shortcut icon" href="images/icon.png">


	<link rel="stylesheet" href="css/reset.css">
	<link rel="stylesheet" href="css/ui-lightness/jquery-ui-1.8.24.custom.css" />
	<link rel="stylesheet" href="css/themes/default/RSVmain.min.css" />
	<link rel="stylesheet" href="css/themes/default/jquery.mobile.structure-1.1.1.min.css" />
	<link rel="stylesheet" href="css/flexslider.css">
	<link rel="stylesheet" href="css/photoswipe.css">
	<link rel="stylesheet" href="css/add2home.css">
	
	
        <link rel="stylesheet/less" href="css/style.blue.css">

	 <!-- fonts -->
	<link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400,600' rel='stylesheet' type='text/css'>
	
	<script type="text/javascript" src="js/jquery.js"></script>
	<script src="js/jquery-ui-1.8.24.custom.min.js"></script>
	
	<script type="text/javascript" src="js/jquery.mobile-1.1.1.min.js"></script>
        <script type="text/javascript" src="js/less-1.3.3.min.js"></script>
        <!--<script type="text/javascript" src="js/jquery-ui-effects.js"></script>-->

	<script src="js/helper.js"></script>
	<script src="js/jquery.flexslider-min.js"></script>
	<script src="js/iphone-style-checkboxes.js"></script>
	<script src="js/klass.min.js"></script>
	<script src="js/code.photoswipe.jquery-3.0.5.min.js"></script>
	<script src="js/add2home.js"></script>
	<script src="http://maps.google.com/maps/api/js?sensor=false"></script>
        
	<script type="text/javascript" src="js/app.js?v=30"></script>
        <script type="text/javascript" charset="utf-8" src="cordova.js"></script>
         <script type="text/javascript" charset="utf-8">

             // Call onDeviceReady when PhoneGap is loaded.
             //
             // At this point, the document has loaded but phonegap-1.0.0.js has not.
             // When PhoneGap is loaded and talking with the native device,
             // it will call the event `deviceready`.
             // 
             document.addEventListener("deviceready", onDeviceReady, false);

             // PhoneGap is loaded and it is now safe to make calls PhoneGap methods
             //
             function onDeviceReady() {
                 // Register the event listener
                 document.addEventListener("backbutton", function (e) {
                     e.preventDefault();
                     navigator.app.backHistory();
                 }, true);
             }

             // Handle the back button
             //
             
    </script>
	<script type="text/javascript">
	    var itemsId = {
	        "checkbox-1a": "Grapefruits",
	        "checkbox-2a": "Apples",
	        "checkbox-3a": "Oranges",
	        "checkbox-4a": "Watermelons",
	        "checkbox-5a": "Pears",
	        "checkbox-6a": "Blueberries",
	        "checkbox-7a": "Strawberries",
	        "checkbox-8a": "Pineapples"

	    };

	    function revertback() {

	        var query1 = window.location.search.substring(1);
	        var vars1 = query1.split("&");

	        window.location.replace("Connection.html?" + vars1[0] + "&" + vars1[1]);

	    }

	    function save() {


	        var stringCheckbox = '';

	        // calculate checked check boxes
	        if (document.getElementById("checkbox-1a").checked) {
	            stringCheckbox = stringCheckbox + "checkbox-1a" + ",";
	        }
	        if (document.getElementById("checkbox-2a").checked) {
	            stringCheckbox = stringCheckbox + "checkbox-2a" + ",";
	        }
	        if (document.getElementById("checkbox-3a").checked) {
	            stringCheckbox = stringCheckbox + "checkbox-3a" + ",";
	        }
	        if (document.getElementById("checkbox-4a").checked) {
	            stringCheckbox = stringCheckbox + "checkbox-4a" + ",";
	        }
	        if (document.getElementById("checkbox-5a").checked) {
	            stringCheckbox = stringCheckbox + "checkbox-5a" + ",";
	        }
	        if (document.getElementById("checkbox-6a").checked) {
	            stringCheckbox = stringCheckbox + "checkbox-6a" + ",";
	        }
	        if (document.getElementById("checkbox-7a").checked) {
	            stringCheckbox = stringCheckbox + "checkbox-7a" + ",";
	        }
	        if (document.getElementById("checkbox-8a").checked) {
	            stringCheckbox = stringCheckbox + "checkbox-8a" + ",";
	        }

	        stringCheckbox = stringCheckbox.substr(0, stringCheckbox.length - 1);
	        var query1 = window.location.search.substring(1);

	        var variables = query1.split("&");
	        $(function () {
	            $.ajax({
	                url: 'http://takegive-12261.onmodulus.net/updategiveritems/' + variables[0] + "&" + stringCheckbox, //the URL to your node.js server that has data
	                dataType: 'json',
	                cache: false
	            }).done(function (data) {
	                //"data" will be JSON. Do what you want with it. 
	                revertback();

	            });
	        });



	    }


	</script>
	
</head> 

<body>
	
	<div data-dom-cache="false" data-role="page" class="pages" id="home" data-theme="a">
        <!-- /header -->
		<div class="clear"></div>
		<br/>
		 <div class="white-content-box">
				
				<h2 class="font-14"> What to give </h2>
				
				<h3 class="font-14"> Items already selected </h2>
				
				<div id="contain-element">
			
				</div>
				
				<div class="clear"></div>

			<div  data-role="fieldcontain">
				<fieldset data-role="controlgroup">
				
				<input type="checkbox" name="checkbox" id="checkbox-1a" class="custom" value="Grapefruits" />
				<label for="checkbox-1a">Grapefruits</label>

				<input type="checkbox" name="checkbox" id="checkbox-2a" class="custom" value="Apples" />
				<label for="checkbox-2a">Apples</label>
				
				<input type="checkbox" name="checkbox" id="checkbox-3a" class="custom" value="Oranges" />
				<label for="checkbox-3a">Oranges</label>

				<input type="checkbox" name="checkbox" id="checkbox-4a" class="custom" value="Watermelons"  />
				<label for="checkbox-4a">Watermelons</label>
				<input type="checkbox" name="checkbox" id="checkbox-5a" class="custom" value="Pears"  />
				<label for="checkbox-5a">Pears</label>
				<input type="checkbox" name="checkbox" id="checkbox-6a" class="custom" value="Blueberries"  />
				<label for="checkbox-6a">Blueberries</label>
				<input type="checkbox" name="checkbox" id="checkbox-7a" class="custom" value="Strawberries"  />
				<label for="checkbox-7a">Strawberries</label>
				<input type="checkbox" name="checkbox" id="checkbox-8a" class="custom" value="Pineapples"  />
				<label for="checkbox-8a">Pineapples</label>
		   
			
			
			
			</fieldset>
		</div>
				<ul class="column-split three-column" >
					<li>
						<a class="button button2" style="width:200px;margin-left:auto;margin-right:auto" onclick= "save()">Save</a>
					</li>
				</ul>	
				
					
			 </div>
			
	    </div>
	    
	<!-- /content -->
    
       </div><!-- /page -->
	   <script type="text/javascript">
	       var query = window.location.search.substring(1);
	       var variables = query.split("&");

	       //window.location = "WhattoGive.html?"+vars[0]+"&"+vars[1] ;

	       $(function () {
	           $.ajax({
	               url: 'http://takegive-12261.onmodulus.net/giverinfo/' + variables[0], //the URL to your node.js server that has data
	               dataType: 'json',
	               cache: false
	           }).done(function (data) {
	               //"data" will be JSON. Do what you want with it. 

	               //	alert("Done");
	               //	window.location ="index.html";
	               if (data.length == 0) {
	                   alert("You are the first");
	               } else {

	                   var s4 = document.getElementById("contain-element");
	                   var html = '<ul>';
	                   var vars = data[0].items.split(",");
	                   for (var i = 0; i < vars.length; i++) {

	                       document.getElementById(vars[i]).checked = true;

	                       html += "<li> " + itemsId[vars[i]] + "</li>";
	                   }
	                   html = html + "</ul>";
	                   s4.innerHTML = html;


	               }


	           });


	       });

	   </script>
	   
	   
</body>
</html>