<!DOCTYPE html> 
<html> 
	<head> 
	<title>Klassio RSV</title> 
	<meta id="extViewportMeta" name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black" />	

	<!-- Home screen icon  Mathias Bynens mathiasbynens.be/notes/touch-icons -->
	<!-- For iPhone 4 with high-resolution Retina display: -->
	<link rel="apple-touch-icon-precomposed" sizes="114x114" href="images/icon.png">
	<!-- For first-generation iPad: -->
	<link rel="apple-touch-icon-precomposed" sizes="72x72" href="images/icon.png">
	<!-- For non-Retina iPhone, iPod Touch, and Android 2.1+ devices: -->
	<link rel="apple-touch-icon-precomposed" href="images/icon.png">
	<!-- For nokia devices: -->
	<link rel="shortcut icon" href="images/icon.png">


	<link rel="stylesheet" href="css/reset.css">
	<link rel="stylesheet" href="css/ui-lightness/jquery-ui-1.8.24.custom.css" />
	<link rel="stylesheet" href="css/themes/default/RSVmain.min.css" />
	<link rel="stylesheet" href="css/themes/default/jquery.mobile.structure-1.1.1.min.css" />
	<link rel="stylesheet" href="css/flexslider.css">
	<link rel="stylesheet" href="css/photoswipe.css">
	<link rel="stylesheet" href="css/add2home.css">
	
	
        <link rel="stylesheet/less" href="css/style.blue.css">

	 <!-- fonts -->
	<link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400,600' rel='stylesheet' type='text/css'>
	
	<script type="text/javascript" src="js/jquery.js"></script>
	<script src="js/jquery-ui-1.8.24.custom.min.js"></script>
	
	<script type="text/javascript" src="js/jquery.mobile-1.1.1.min.js"></script>
        <script type="text/javascript" src="js/less-1.3.3.min.js"></script>
        <!--<script type="text/javascript" src="js/jquery-ui-effects.js"></script>-->

	<script src="js/helper.js"></script>
	<script src="js/jquery.flexslider-min.js"></script>
	<script src="js/iphone-style-checkboxes.js"></script>
	<script src="js/klass.min.js"></script>
	<script src="js/code.photoswipe.jquery-3.0.5.min.js"></script>
	<script src="js/add2home.js"></script>
	<script src="http://maps.google.com/maps/api/js?sensor=false"></script>
        
	<script type="text/javascript" src="js/app.js?v=30"></script>
        <script type="text/javascript" charset="utf-8" src="cordova.js"></script>
         <script type="text/javascript" charset="utf-8">

             // Call onDeviceReady when PhoneGap is loaded.
             //
             // At this point, the document has loaded but phonegap-1.0.0.js has not.
             // When PhoneGap is loaded and talking with the native device,
             // it will call the event `deviceready`.
             // 
             document.addEventListener("deviceready", onDeviceReady, false);

             // PhoneGap is loaded and it is now safe to make calls PhoneGap methods
             //
             function onDeviceReady() {
                 // Register the event listener
                 document.addEventListener("backbutton", function (e) {
                     e.preventDefault();
                     navigator.app.backHistory();
                 }, true);
             }

             // Handle the back button
             //
            

    </script>
	<script type="text/javascript">

	    var itemsId = {
	        "checkbox-1a": "Grapefruits",
	        "checkbox-2a": "Apples",
	        "checkbox-3a": "Oranges",
	        "checkbox-4a": "Watermelons",
	        "checkbox-5a": "Pears",
	        "checkbox-6a": "Blueberries",
	        "checkbox-7a": "Strawberries",
	        "checkbox-8a": "Pineapples"

	    };

	    function edit() {
	        var query2 = window.location.search.substring(1);

	        window.location.replace("EditingTaker.html?" + query2);
	    }


	    function connectReq() {

	        var query1 = window.location.search.substring(1);

	        $(function () {
	            $.ajax({
	                url: 'http://takegive-12261.onmodulus.net/addconnection/' + document.getElementById('select-choice-min').value + "&" + query1, //the URL to your node.js server that has data
	                dataType: 'json',
	                cache: false
	            }).done(function (data) {
	                //"data" will be JSON. Do what you want with it. 

	                if (data.length == 0) {
	                   // alert("You are the first");
	                } else {

	                    $(function () {
	                        $.ajax({
	                            url: 'http://takegive-12261.onmodulus.net/notification/' + query1 + "&" + document.getElementById('select-choice-min').value, //the URL to your node.js server that has data
	                            dataType: 'json',
	                            cache: false
	                        }).done(function (data) {
	                            //"data" will be JSON. Do what you want with it. 

	                            if (data.length == 0) {
	                                alert("You are the first");
	                            } else {

	                                //window.location.replace("Connectionmain.html");
	                                alert("Notification has been sent to " + document.getElementById('select-choice-min').value);
	                                window.location.replace("Connectionmain.html");
	                            }
	                        });
	                    });



	                }
	            });
	        });






	    }


	</script>
	
	
</head> 

<body>
	
	<div data-dom-cache="false" data-role="page" class="pages" id="home" data-theme="a">
        <!-- /header -->
		<div class="clear"></div>
		<br/>
		 <h1><center>View Taker</center></h1>
		 <div class="white-content-box">
				
				<b>Name</b> : <div id="name"></div>
				</br>
				<b>Email</b> : <div id="email"></div>
				</br>
				<h2 class="font-14"> <b>Needs!</b> </h2>
				
				<div id="contain-item">
				
				</div>
						
				<ul class="column-split three-column">
					<li>
						<a class="button button2" style="width:200px" onclick="edit()">Edit</a>
					</li>
				</ul>
				</br>
				 <div class="clear"></div>
            </div>
			 <div class="white-content-box">
				<h2 class="font-14"> <b>Create a Connection with </b></h2>
				<div class="clear"></div>
				
					<div id="select">
					<select name="select-choice-min" id="select-choice-min" data-mini="true">
						
					</select>
					</div>
			 </div>
			 <div class="white-content-box">
				<ul class="column-split three-column" >
					<li>
						<a class="button button3" style="width:200px;margin-left:auto;margin-right:auto" onclick = "connectReq()">Connect!</a>
					</li>
				</ul>	
			
			</div>
	    </div>
	    
	<!-- /content -->
    
       </div><!-- /page -->
	   <script type="text/javascript">

	       jQuery(document).ready(function () {


	           var contain;
	           var query;


	           query = window.location.search.substring(1);
	           $.ajax({
	               url: 'http://takegive-12261.onmodulus.net/takerinfo/' + query, //the URL to your node.js server that has data
	               dataType: 'json',
	               cache: false,
	               async: false

	           }).done(function (data) {

	               //alert(data[0].id);
	               // alert(data[0].name);

	               //"data" will be JSON. Do what you want with it. 
	               //	alert(data);

	               //			alert("Done");
	               //	window.location ="index.html";
	               if (data.length == 0) {
	                   alert("You are the first");
	               } else {


	                   var naming = document.getElementById("name");
	                   naming.innerHTML = data[0].name;

	                   var address = document.getElementById("email");
	                   address.innerHTML = data[0].email;
	                   var item = data[0].items;

	                   //alert(data[0].phone);

	                   var s2 = document.getElementById("contain-item");
	                   var html = '<ul>';
	                   var vars = item.split(",");
	                   for (var i = 0; i < vars.length; i++) {
	                       html += "<li> " + itemsId[vars[i]] + "</li>";
	                   }
	                   html = html + "</ul>";
	                   s2.innerHTML = html;


	               }
	           });



	           $.ajax({
	               url: 'http://takegive-12261.onmodulus.net/listgiver', //the URL to your node.js server that has data
	               dataType: 'json',
	               cache: false,
	               async: false

	           }).done(function (data) {


	               if (data.length == 0) {
	                   alert("You are the first");
	               } else {
	                   var select = document.getElementById("select-choice-min");

	                   var html;
	                   for (var j = 0 ; j < data.length ; j++) {

	                       html += "<option value='" + data[j].name + "'>" + data[j].name + "</option>";

	                   }
	                   select.innerHTML = html;

	                   //	s2.appendChild(newDiv);
	               }
	           });



	       });

	   </script>
	   
	   
</body>
</html>